# 설계 초안
0. 최우선 중요도 -> 기능구현
- css 는 pico.css 로 최소한의 스타일링을 유지한다.
- 기능 안정성이 제일 중요.
- 기능구현 다음 중요한것은 테스트코드 작성

1. 기능 명세 파악 및 브래인스토밍
    1. 가격대별 구매 빈도 차트
       1. 날짜를 조작해서 필터링 기능 구현 필요
       2. 바차트 페이지 필요
       3. 어떤 차트라이브러리 쓸까 고민(인터페이스 가장 간단한것으로, 그 다음 고려사항은 확장성(헤드리스))
       4. 날짜 구조.
          1. 시간까지 고려할 필요는 없으므로 input type="date"로 구현
          2. 시간다루는 외부라이브러리는 일단 사용 안함
       3. UI 고려사항
          1. y축은 가격대 포멧 - 2만원 이하, 2만원 초과 3만원 이하, 3만원 초과 4만원 이하, 4만원 초과 5만원 이하, 5만원 초과 6만원 이하, 6만원 초과 7만원 이하, 7만원 초과 8만원 이하, 8만원 초과 9만원 이하, 9만원 초과 10만원 이하
             1. x축에다 둘 경우 가격대 글자수가 너무 길어 ux적으로 불편
          2. x축은 구매 빈도
          3. echart가 차트 표현에 유연하므로 선택!()
    2. 가장 많이 구매한 고객 목록 및 검색 기능
        1. 기본 테이블 + 필터기능 필요 -> 테이블라이브러리도 간단한 인터페이스 최우선 그 다음이 확장성(헤드리스)
        2. 이름으로 검색하는 api 호출 최적화(debounce) 필요. 
        3. UI 고려사항
           1. 상세 페이지 룩업은 모달로 표현할지, 하단에 공간을 추가할지 고민
               1. 구현이 쉬운 후자로 먼저 시도한 뒤 시간이 남으면 모달형태로 디벨롭한다.
           2. 정렬 기능은 어디에 표현할지 고민
              1. 테이블 헤더에 기본으로 정렬기능 있는 라이브러리 선택 or 별도 기능으로 구현할지는 고민해보자.
    3. 고객 ID 기반 상세 기능
       1. 구매 내역 아이템 마다 카드형식으로 표현
       2. UI 고려사항
          1. 구매 내역은 카드형식으로 구현
    

2. 데이터 구조 파악
   1. api interface 파악
   2. api 인자 예외케이스 파악
      1. 시간이 된다면 api 테스트 코드 작성

3. 기능구현 완벽히 한 후 고민할 것
   1. 클라이언트에서 다루는 에러케이스 공통으로 처리하기 모듈 확장
   2. 반응형  UI 고민하기. 
      1. 기본적으로 위젯형식으로 구현하자.
   3. 테스트코드는 어느수준까지 고려해야하는가?
      1. 현재까지 요구사항을 이해한 바탕으로는, 로컬서버라서 아무래도 e2e로 검증하는것이 충분히 가능할 것으로 보임
      2. e2e를 할거면 playwright 써보자.
      1. 시간이 남는다면 api 테스트 코드 작성
         1. 제공해주는 문서에서 알 수 없는 컨텍스트(엣지케이스 등)를 문서로 정리하는 목적
         

4. 기타
- purchaseFrequency api에 forEach를 사용하면서 return을 break로 사용하는 코드 존재. forEach에서는 iterator를 멈출 수 없다는것을 알고 있는지 파악하려고 일부로 넣은 함정이라고 판단했습니다. 다만 주어진 DB상으로는 문제가 발생하지 않기 때문에 코드를 수정하진 않았습니다.

5. 회고
- 생각했던 것보다 헤멘 시간이 많았습니다.
- 테스트코드를 작성하지 못한것이 아쉽습니다.
- 시간을 아끼려고 pico.css를 선택했지만, 생각보다 스타일링이 원하는대로 나오지 않아 시간을 많이 빼앗겼습니다.
- 차트라이브러리 선택하는데 병목이 있었습니다. 처음에 rechart를 선택하려 했으나, x축과 y축을 유연하게 바꾸는 기능이 없다는걸(혹은 못찾은것일수도...) 알기까지 시간이 걸렸습니다.
  - 결국 echart를 선택하였는데, pico.css와 호환이 잘 되지 않는 부분(padding 으로 인해 일부 차트가 잘리는 현상)이 있었습니다. 최대한 수정한다 했는데 완벽한 해결은 아니라 아쉽습니다.
- 날짜선택 field를 다루는데 임시상태와 committed 상태를 구분해야하는 필요성을 너무 늦게 알아차렸습니다.
  - input type="date"는 date picker 에서 선택하지 않더라도 value가 변경되는 현상이 있어서(달을 변경하면 onChange가 발생), 이를 임시상태에 저장하고, committed(날짜적용하기 액션) 상태에서만 api를 호출하도록 구현했습니다. 
- api에서 제공하는 DTO를 그대로 사용하지 않고, 클라이언트에서 일부 포멧팅을 제어하여 추상화 벽(convert~~~ 함수)을 세웠습니다. 
  - 이는 서버 스키마와 ui 기획의 물리적 격리효과를 가져와, 변경에 유연한 대응이 가능한 장점을 가져옵니다.